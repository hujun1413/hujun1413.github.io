---
title:  3.创建和编译ROS程序包
date: 2016-09-26 20:39:26 # 文章生成时间，一般不改
categories:   # 文章分类目录，参数可省略
    - OSLab
    - ROS
tags:   # 文章标签，参数可省略
    - catkin_create_pkg
    - rospack depends1
    - catkin_make
---
## 创建ROS程序包
### catkin程序包的组成
一个程序包要想称为catkin程序包必须符合以下要求：
<!--more-->

* 该程序包必须包含catkin compliant package.xml文件
这个package.xml文件提供有关程序包的元信息。

* 程序包必须包含一个catkin 版本的CMakeLists.txt文件，而Catkin metapackages中必须包含一个对CMakeList.txt文件的引用。

* 每个目录下只能有一个程序包。
这意味着在同一个目录下不能有嵌套的或者多个程序包存在。

* 最简单的程序包也许看起来就像这样：
```bash
my_package/
  CMakeLists.txt
  package.xml
```
### 在catkin工作空间中的程序包
开发catkin程序包的一个推荐方法是使用catkin工作空间，但是你也可以单独开发(standalone)catkin 软件包。一个简单的工作空间也许看起来像这样：
```linux
workspace_folder/        -- WORKSPACE
  src/                   -- SOURCE SPACE
    CMakeLists.txt       -- 'Toplevel' CMake file, provided by catkin
    package_1/
      CMakeLists.txt     -- CMakeLists.txt file for package_1
      package.xml        -- Package manifest for package_1
    ...
    package_n/
      CMakeLists.txt     -- CMakeLists.txt file for package_n
      package.xml        -- Package manifest for package_n
```
### catkin程序包
首先切换到之前通过创建catkin工作空间教程创建的catkin工作空间中的src目录下：
```linux
# You should have created this in the Creating a Workspace Tutorial
$ cd ~/catkin_ws/src
```
现在使用catkin_create_pkg命令来创建一个名为'beginner_tutorials'的新程序包，这个程序包依赖于std_msgs、roscpp和rospy：
```linux
$ catkin_create_pkg beginner_tutorials std_msgs rospy roscpp
```
这将会创建一个名为beginner_tutorials的文件夹，这个文件夹里面包含一个package.xml文件和一个CMakeLists.txt文件，这两个文件都已经自动包含了部分你在执行catkin_create_pkg命令时提供的信息。
catkin_create_pkg命令会要求你输入package_name，如果有需要你还可以在后面添加一些需要依赖的其它程序包：
```linux
# This is an example, do not try to run this
# catkin_create_pkg <package_name> [depend1] [depend2] [depend3]
```
### 程序包依赖关系
#### 一级依赖
之前在使用catkin_create_pkg命令时提供了几个程序包作为依赖包，现在我们可以使用rospack命令工具来查看一级依赖包。
```linux
rospack depends1 beginner_tutorials 
```
#### 间接依赖
一个程序包还可以有好几个间接的依赖包，幸运的是使用rospack可以递归检测出所有的依赖包。
```linux
rospack depends beginner_tutorials
```
### 自定义你的程序包
#### 描述标签
```
<description>The beginner_tutorials package</description>
```
#### 维护者标签 
```
<maintainer email="hujun1413@bupt.edu.cn">胡君</maintainer>
```
#### 许可标签
```
<license>BSD</license>
```
#### 依赖项标签
```
<buildtool_depend>catkin</buildtool_depend>

<build_depend>roscpp</build_depend>
<build_depend>rospy</build_depend>
<build_depend>std_msgs</build_depend>

<run_depend>roscpp</run_depend>
<run_depend>rospy</run_depend>
<run_depend>std_msgs</run_depend>
```
## 编译ROS程序包
### 使用catkin_make
catkin_make 是一个命令行工具，它简化了catkin的标准工作流程。你可以认为catkin_make是在CMake标准工作流程中依次调用了cmake 和 make。
```bash
cd ~/catkin_ws/
catkin_make
# want to re-build just one package(package_name)
catkin_make --pkg package_name
```


